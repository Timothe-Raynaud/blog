<div id="sign-in" class="col-lg-8 px-5 d-none">
    <div class="mb-4">
        <a href="javascript:void(0)" onclick="hideAndShow('sign-in', 'login')">
            <div class=""><i class="fa-solid fa-chevron-left"></i>&nbsp;Se connecter</div>
        </a>
    </div>
    <h3 class="text-center mb-3 border-bottom pb-3">Inscription</h3>
    <form action="/inscription" method="post">
        <div class="pb-3">
            <label for="" class="form-label d-block">Email </label>
            <input name="email" type="email" class="w-100 form-control rounded" required>
        </div>
        <div class="pb-3 w-100 me-md-2">
            <label for="" class="form-label d-block">Nom d'utilisateur </label>
            <input name="username" type="text" class="w-100 form-control rounded" required id="is-available-username">
            <span id="username-availability" class="fs-6 fst-italic fw-lighter"></span>
        </div>
        <div class="pb-3">
            <label for="" class="form-label d-block">Login </label>
            <input name="login" type="text" class="w-100 form-control rounded" required id="is-available-login">
            <span id="login-availability" class="fs-6 fst-italic fw-lighter"></span>
        </div>
        <div class="pb-3">
            <label for="" class="form-label d-block">Password </label>
            <input type="password" class="form-control rounded w-100" name="password" rows="5" cols="50" maxlength="200"
                   required>
        </div>
        <div class="text-center mb-4">
            <input type="submit" VALUE="S'inscrire" class="btn btn-primary rounded shadow" id="sign-in-submit">
        </div>
    </form>
</div>


<script>
    function testDisponibilityOfField(element, name) {
        const value = element.value

        fetch(window.location.origin + '/is-' + name + '-exist?' + encodeURIComponent(value))
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error('Erreur de connexion');
                }
            })
            .then(data => {
                const availability = document.getElementById(name + '-availability')

                if (value === '') {
                    element.style.backgroundColor = '#fff'
                    availability.innerText = ''
                } else if (data.exist === 'true') {
                    element.style.backgroundColor = 'rgba(159, 0, 0, 0.13)'
                    availability.innerText = 'Non disponible'
                } else {
                    element.style.backgroundColor = 'rgba(0, 169, 96, 0.13)'
                    availability.innerText = 'Disponible'
                }
            })
            .catch(error => console.error(error))
    }

    // Test Validity input inscription
    const loginField = document.getElementById('is-available-login')
    const usernameField = document.getElementById('is-available-username')

    loginField.addEventListener('input', () => testDisponibilityOfField(loginField, 'login'))
    usernameField.addEventListener('input', () => testDisponibilityOfField(usernameField, 'username'))

</script>
