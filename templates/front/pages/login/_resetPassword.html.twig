<div id="reset-password" class="col-lg-8 px-5 mb-4 d-none">
    <form action="" class="m-auto pt-0" id="form-reset">
        <a href="javascript:void(0)" onclick="hideAndShow('reset-password', 'login')">
            <div class="mb-4"><i class="fa-solid fa-chevron-left"></i>&nbsp;Retour</div>
        </a>
        <h3 class="mb-4">Renvoie d'un mot de passe</h3>
        <div class="pb-3">
            <label for="" class="form-label d-block">Email</label>
            <input type="email" class="form-control rounded w-100" name="email" rows="5" cols="50" maxlength="200"
                   required></input>
        </div>
        <div class="text-center">
            <input type="submit" VALUE="Renvoyer un mot de passe" class="btn btn-primary rounded shadow">
        </div>
    </form>
</div>

<script>
    const formReset = document.getElementById('form-reset');

    formReset.addEventListener('submit', (event) => {
        event.preventDefault();

        const emailInput = document.querySelector('input[name=email]');

        const formDataReset = new FormData();
        formDataReset.append('login', emailInput.value);

        fetch('/reset-password', {
            method: 'POST',
            body: formDataReset
        })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error('Erreur de connexion');
                }
            })
            .then(data => {
                if (data.isConnecting) {
                    window.location.href = '/my-account';
                } else {
                    showFlashMessage('login-flash', data.message, 'danger')
                }
            })
            .catch(error => console.error(error));
    });
</script>