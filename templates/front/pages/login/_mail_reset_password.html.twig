<div id="reset-password" class="col-lg-8 px-5 mb-4 d-none">
    <form action="/reset-password" class="m-auto pt-0" id="form-mail-reset" method="post">
        <a href="javascript:void(0)" onclick="hideAndShow('reset-password', 'login')">
            <div class="mb-4"><i class="fa-solid fa-chevron-left"></i>&nbsp;Retour</div>
        </a>
        <h3 class="text-center mb-3 border-bottom pb-3">Renvoie d'un mot de passe</h3>
        <div class="pb-3">
            <label for="" class="form-label fs-6">Email</label>
            <input type="email" class="form-control rounded w-100" name="email" rows="5" cols="50" maxlength="200"
                   required></input>
        </div>
        <div class="text-center">
            <input type="submit" VALUE="Renvoyer un mot de passe" class="btn btn-primary rounded shadow" id="form-submit-send-reset">
        </div>
    </form>
</div>

<script>
    const formResetMail = document.getElementById('form-mail-reset')
    const formSubmitReset = document.getElementById('form-submit-send-reset')

    formResetMail.addEventListener('submit', (event) => {
        event.preventDefault()
        formSubmitReset.disabled = true

        const emailInput = document.querySelector('input[name=email]')
        const formDataResetMail = new FormData()
        formDataResetMail.append('email', emailInput.value)

        fetch('/send-reset-password', {
            method: 'POST',
            body: formDataResetMail
        })
            .then(response => {
                if (response.ok) {
                    return response.json()
                } else {
                    throw new Error('Erreur de connexion')
                }
            })
            .then(data => {
                if (data.isSend) {
                    showFlashMessage('login-flash', data.message, 'success')
                } else {
                    showFlashMessage('login-flash', data.message, 'danger')
                }
            })
            .catch(error => console.error(error))
            .finally(() => {
                setTimeout(() => {
                    formSubmitReset.disabled = false
                }, 2000)
            })
    })
</script>